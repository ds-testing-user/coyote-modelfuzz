//------------------------------------------------------------------------------
// <auto-generated>
// Well, not really. This is just a trick to get StyleCop off my back.
// </auto-generated>
//------------------------------------------------------------------------------
using System;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.Coyote.Actors;

namespace MicroBenchmark;

[OnEventDoAction(typeof(InitEvent), nameof(HandleInit))]
public class Client : Actor
{
    private ClientSetupEvent ClientInfo;

    protected override Task OnInitializeAsync(Event initialEvent)
    {
        var setup = initialEvent as ClientSetupEvent;
        this.ClientInfo = setup;
        var random = Microsoft.Coyote.Random.Generator.Create();
        // int w = random.NextInteger(this.ClientInfo.NumWorkers);
        this.SendEvent(this.ClientInfo.AppMaster, new RequestEvent(0, 1));
        return Task.CompletedTask;
    }

    private void HandleInit()
    {
        this.Logger.WriteLine("Starting HandleInit");
        var random = Microsoft.Coyote.Random.Generator.Create();
        // int w = random.NextInteger(this.ClientInfo.NumWorkers);
        this.SendEvent(this.ClientInfo.AppMaster, new RequestEvent(0, 1));
    }
}
