//------------------------------------------------------------------------------
// <auto-generated>
// Well, not really. This is just a trick to get StyleCop off my back.
// </auto-generated>
//------------------------------------------------------------------------------
using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.Coyote.Actors;

namespace MicroBenchmark;

[OnEventDoAction(typeof(TerminateEvent), nameof(HandleTerminate))]
[OnEventDoAction(typeof(InitEvent), nameof(HandleInit))]
public class Terminator : Actor
{
    private TerminatorSetupEvent TerminatorInfo;

    protected override Task OnInitializeAsync(Event initialEvent)
    {
        var setup = initialEvent as TerminatorSetupEvent;
        this.TerminatorInfo = setup;
        this.SendEvent(this.TerminatorInfo.AppMaster, new RegisterTerminatorEvent(this.Id));
        return Task.CompletedTask;
    }

    private void HandleTerminate(Event e)
    {
        var te = e as TerminateEvent;
        this.SendEvent(te.Id, new FlushEvent(te.Id));
    }

    private void HandleInit()
    {
        this.Logger.WriteLine("Starting HandleInit");
        this.SendEvent(this.TerminatorInfo.AppMaster, new RegisterTerminatorEvent(this.Id));
    }
}
